import numpy as np
import five_link


def test_P_W():
    correct_output = np.array([[1,0,0],
                               [0,1,0],
                               [0,0,1],
                               [1,0,0],
                               [0,1,0],
                               [0,0,1],
                               [1,0,0],
                               [0,1,0],
                               [0,0,1],
                               [1,0,0],
                               [0,1,0],
                               [0,0,1],
                               [1,0,0],
                               [0,1,0],
                               [0,0,1]])
    
    assert five_link.__gen_P_W__().all() == correct_output.all()

def test_P_R():
    upright_pickups = np.array([[1,2,3],
                                [4,5,6],
                                [7,8,9],
                                [10,11,12],
                                [13,14,115]])
    
    correct_output = np.array([[1,0,0,2,0,0,3,0,0],
                               [0,1,0,0,2,0,0,3,0],
                               [0,0,1,0,0,2,0,0,3],
                               [4,0,0,5,0,0,6,0,0],
                               [0,4,0,0,5,0,0,6,0],
                               [0,0,4,0,0,5,0,0,6],
                               [7,0,0,8,0,0,9,0,0],
                               [0,7,0,0,8,0,0,9,0],
                               [0,0,7,0,0,8,0,0,9],
                               [10,0,0,11,0,0,12,0,0],
                               [0,10,0,0,11,0,0,12,0],
                               [0,0,10,0,0,11,0,0,12],
                               [13,0,0,14,0,0,15,0,0],
                               [0,13,0,0,14,0,0,15,0],
                               [0,0,13,0,0,14,0,0,15]])
    assert five_link.__gen_P_R__(upright_pickups).all() == correct_output.all()
def test_P_AB():
    lengths = np.array([21,22,23,24,25])

    correct_output = np.array([[-21,0,0],
                               [0,-21,0],
                               [0,0,-21],
                               [-22,0,0],
                               [0,-22,0],
                               [0,0,-22],
                               [-23,0,0],
                               [0,-23,0],
                               [0,0,-23],
                               [-24,0,0],
                               [0,-24,0],
                               [0,0,-24],
                               [-25,0,0],
                               [0,-25,0],
                               [0,0,-25]])
    assert five_link.__gen_P_AB__(lengths).all() == correct_output.all()

def test_P():
    upright_pickups = np.array([[1,2,3],
                                [4,5,6],
                                [7,8,9],
                                [10,11,12],
                                [13,14,115]])
    
    lengths = np.array([21,22,23,24,25])

    correct_output = np.array([[1,0,0, 1,0,0,2,0,0,3,0,0,    -21,0,0],
                               [0,1,0, 0,1,0,0,2,0,0,3,0,    0,-21,0],
                               [0,0,1, 0,0,1,0,0,2,0,0,3,    0,0,-21],
                               [1,0,0, 4,0,0,5,0,0,6,0,0,    -22,0,0],
                               [0,1,0, 0,4,0,0,5,0,0,6,0,    0,-22,0],
                               [0,0,1, 0,0,4,0,0,5,0,0,6,    0,0,-22],
                               [1,0,0, 7,0,0,8,0,0,9,0,0,   - 23,0,0],
                               [0,1,0, 0,7,0,0,8,0,0,9,0,    0,-23,0],
                               [0,0,1, 0,0,7,0,0,8,0,0,9,    0,0,-23],
                               [1,0,0, 10,0,0,11,0,0,12,0,0, -24,0,0],
                               [0,1,0, 0,10,0,0,11,0,0,12,0, 0,-24,0],
                               [0,0,1, 0,0,10,0,0,11,0,0,12, 0,0,-24],
                               [1,0,0, 13,0,0,14,0,0,15,0,0, -25,0,0],
                               [0,1,0, 0,13,0,0,14,0,0,15,0, 0,-25,0],
                               [0,0,1, 0,0,13,0,0,14,0,0,15, 0,0,-25] ])
 
    
    assert five_link.__gen_P__(upright_pickups, lengths).all() == correct_output.all()


def test_A():
    frame_pickups = np.array([[31,32,33],
                                [34,35,36],
                                [37,38,39],
                                [40,41,42],
                                [43,44,45]])
    
    correct_output = np.array([[31],
                                [32],
                                [33],
                                [34],
                                [35],
                                [36],
                                [37],
                                [38],
                                [39],
                                [40],
                                [41],
                                [42],
                                [43],
                                [44],
                                [45]])

    assert five_link.__gen_A__(frame_pickups).all() == correct_output.all()
